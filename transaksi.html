<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Transaksi Rental Mobil</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<!-- ===== NAVBAR ===== -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container">
    <a class="navbar-brand fw-bold" href="#">RentalMobil</a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#menu">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="menu">
      <ul class="navbar-nav ms-auto align-items-center">
        <li class="nav-item"><a class="nav-link" href="beranda.html">Beranda</a></li>
        <li class="nav-item"><a class="nav-link" href="profil.html">Profil</a></li>
        <li class="nav-item"><a class="nav-link" href="katalogmobil.html">Katalog</a></li>
        <li class="nav-item"><a class="nav-link active" href="#">Transaksi</a></li>
        <li class="nav-item ms-2">
          <button class="btn btn-warning btn-sm" onclick="logout()">Logout</button>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="container py-4">

  <h3 class="text-center mb-4 fw-bold">Form Transaksi Rental Mobil</h3>

  <!-- ===== FORM TRANSAKSI ===== -->
  <div class="card mb-4 shadow">
    <div class="card-header bg-primary text-white">Form Transaksi</div>
    <div class="card-body">

      <div class="mb-3">
        <label class="form-label">Nama Penyewa</label>
        <input type="text" id="nama" class="form-control">
      </div>

      <div class="mb-3">
        <label class="form-label">Tanggal Mulai</label>
        <input type="date" id="tanggal" class="form-control">
      </div>

      <div class="mb-3">
        <label class="form-label">Mobil</label>
        <select id="mobil" class="form-select" onchange="ubahMobil()">
          <option value="">-- Pilih Mobil --</option>
          <option value="Avanza">Avanza</option>
          <option value="Brio">Brio</option>
          <option value="Innova">Innova</option>
          <option value="BMW Series 3">BMW Series 3</option>
        </select>
      </div>

      <div class="mb-3">
        <label class="form-label">Harga / Hari</label>
        <input type="text" id="harga" class="form-control" readonly>
      </div>

      <div class="mb-3">
        <label class="form-label">Lama Sewa (Hari)</label>
        <input type="number" id="lama" class="form-control" min="1" oninput="hitungTotal()">
      </div>

      <div class="mb-3">
        <label class="form-label">Total Bayar</label>
        <input type="text" id="total" class="form-control" readonly>
      </div>

      <button class="btn btn-success w-100" onclick="ajukanSewa()">Ajukan Sewa</button>
    </div>
  </div>

  <!-- ===== DAFTAR KELUAR MASUK ===== -->
  <div class="card shadow">
    <div class="card-header bg-dark text-white">Daftar Keluar â€“ Masuk Mobil</div>
    <div class="card-body table-responsive">
      <table class="table table-bordered align-middle text-center">
        <thead class="table-secondary">
          <tr>
            <th>Nama</th>
            <th>Mobil</th>
            <th>Tanggal Keluar</th>
            <th>Tanggal Masuk</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody id="tabel"></tbody>
      </table>
    </div>
  </div>

</div>

<script>
/* ===== DATA HARGA ===== */
const hargaMobil = {
  "Avanza": 350000,
  "Brio": 300000,
  "Innova": 500000,
  "BMW Series 3": 120000
};

/* ===== LOAD SAAT HALAMAN ===== */
document.addEventListener("DOMContentLoaded", renderTabel);

/* ===== FORM ===== */
function ubahMobil() {
  const mobil = mobilSelect().value;
  hargaInput().value = mobil ? hargaMobil[mobil] : "";
  hitungTotal();
}

function hitungTotal() {
  totalInput().value =
    hargaInput().value && lamaInput().value > 0
      ? hargaInput().value * lamaInput().value
      : "";
}

/* ===== AJUKAN SEWA ===== */
function ajukanSewa() {
  if (!namaInput().value || !tanggalInput().value || !mobilSelect().value || lamaInput().value < 1) {
    alert("Semua data wajib diisi!");
    return;
  }

  let data = JSON.parse(localStorage.getItem("dataKeluarMasuk")) || [];

  let tglMasuk = new Date(tanggalInput().value);
  tglMasuk.setDate(tglMasuk.getDate() + parseInt(lamaInput().value));

  data.push({
    nama: namaInput().value,
    mobil: mobilSelect().value,
    keluar: tanggalInput().value,
    masuk: tglMasuk.toISOString().split("T")[0],
    status: "Keluar"
  });

  localStorage.setItem("dataKeluarMasuk", JSON.stringify(data));

  renderTabel();
  resetForm();
  alert("Transaksi berhasil ditambahkan!");
}

/* ===== TABEL ===== */
function renderTabel() {
  const tbody = document.getElementById("tabel");
  tbody.innerHTML = "";

  let data = JSON.parse(localStorage.getItem("dataKeluarMasuk")) || [];

  data.forEach(d => {
    tbody.innerHTML += `
      <tr>
        <td>${d.nama}</td>
        <td>${d.mobil}</td>
        <td>${d.keluar}</td>
        <td>${d.masuk}</td>
        <td><span class="badge bg-success">${d.status}</span></td>
      </tr>
    `;
  });
}

/* ===== RESET ===== */
function resetForm() {
  namaInput().value = "";
  tanggalInput().value = "";
  mobilSelect().value = "";
  hargaInput().value = "";
  lamaInput().value = "";
  totalInput().value = "";
}

/* ===== LOGOUT ===== */
function logout() {
  localStorage.clear();
  alert("Berhasil logout");
  window.location.href = "login.html";
}

/* ===== SHORTCUT ===== */
const namaInput = () => document.getElementById("nama");
const tanggalInput = () => document.getElementById("tanggal");
const mobilSelect = () => document.getElementById("mobil");
const hargaInput = () => document.getElementById("harga");
const lamaInput = () => document.getElementById("lama");
const totalInput = () => document.getElementById("total");
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>